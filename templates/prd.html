{% extends 'base.html' %}
{% block content %}
<div class="d-flex justify-content-between align-items-start flex-wrap mb-4">
  <div class="me-4">
    <p class="text-uppercase text-info mb-1 small">产品需求文档</p>
    <h3 class="mb-2">{{ prd.product.name }}</h3>
    <p class="text-muted mb-0">{{ prd.product.purpose }}</p>
  </div>
  <div class="text-end">
    <span class="badge bg-gradient">V1 聚焦本地+云端一体化</span>
  </div>
</div>

<div class="row g-4 mb-4">
  <div class="col-lg-4">
    <div class="card h-100">
      <div class="card-header">定量目标</div>
      <div class="card-body">
        <ul class="mb-0">
          {% for goal in prd.product.goals %}
            <li class="mb-2">{{ goal }}</li>
          {% endfor %}
        </ul>
      </div>
    </div>
  </div>
  <div class="col-lg-8">
    <div class="card h-100">
      <div class="card-header">核心人群与关注点</div>
      <div class="card-body p-0">
        <div class="table-responsive">
          <table class="table table-dark table-hover mb-0">
            <thead>
              <tr>
                <th>角色</th>
                <th>关注点</th>
              </tr>
            </thead>
            <tbody>
              {% for owner in prd.owners %}
                <tr>
                  <td>{{ owner.role }}</td>
                  <td>
                    {% for focus in owner.focus %}
                      <span class="badge text-bg-secondary me-1 mb-1">{{ focus }}</span>
                    {% endfor %}
                  </td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="card mb-4">
  <div class="card-header">关键业务场景</div>
  <div class="card-body">
    <div class="row g-3">
      {% for scene in prd.scenarios %}
        <div class="col-md-4">
          <div class="p-3 border rounded h-100 bg-dark-subtle text-dark">
            <div class="fw-semibold mb-1">场景 {{ loop.index }}</div>
            <p class="mb-0">{{ scene }}</p>
          </div>
        </div>
      {% endfor %}
    </div>
  </div>
</div>

<div class="row g-4 mb-4">
  <div class="col-md-6">
    <div class="card h-100">
      <div class="card-header">V1 必做范围</div>
      <div class="card-body">
        <ul class="mb-0 list-unstyled">
          {% for item in prd.scope.must %}
            <li class="mb-2"><i class="bi bi-check2-circle text-success me-2"></i>{{ item }}</li>
          {% endfor %}
        </ul>
      </div>
    </div>
  </div>
  <div class="col-md-6">
    <div class="card h-100">
      <div class="card-header">暂不纳入</div>
      <div class="card-body">
        <ul class="mb-0 list-unstyled">
          {% for item in prd.scope.exclude %}
            <li class="mb-2"><i class="bi bi-slash-circle text-warning me-2"></i>{{ item }}</li>
          {% endfor %}
        </ul>
      </div>
    </div>
  </div>
</div>

<div class="card mb-4">
  <div class="card-header">端到端流程</div>
  <div class="card-body">
    <div class="row g-4">
      {% for process in prd.processes %}
        <div class="col-md-6">
          <div class="border rounded p-3 h-100">
            <h6 class="fw-semibold">{{ process.name }}</h6>
            <ol class="mb-0 ps-3">
              {% for step in process.steps %}
                <li class="mb-1">{{ step }}</li>
              {% endfor %}
            </ol>
          </div>
        </div>
      {% endfor %}
    </div>
  </div>
</div>

<div class="card mb-4">
  <div class="card-header">模块规划</div>
  <div class="card-body">
    <div class="row g-4">
      {% for module in prd.modules %}
        <div class="col-md-6">
          <div class="p-3 border rounded h-100">
            <div class="d-flex justify-content-between align-items-center mb-2">
              <h6 class="mb-0">{{ module.name }}</h6>
              <span class="badge bg-secondary-subtle text-dark">{{ module.capabilities|length }} 能力</span>
            </div>
            <div class="d-flex flex-wrap gap-2">
              {% for item in module.capabilities %}
                <span class="badge text-bg-dark">{{ item }}</span>
              {% endfor %}
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  </div>
</div>

<div class="card">
  <div class="card-header">验收指标</div>
  <div class="card-body p-0">
    <div class="table-responsive">
      <table class="table table-striped mb-0">
        <thead>
          <tr>
            <th>指标</th>
            <th>目标</th>
          </tr>
        </thead>
        <tbody>
          {% for metric in prd.metrics %}
            <tr>
              <td>{{ metric.name }}</td>
              <td>{{ metric.target }}</td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %}
